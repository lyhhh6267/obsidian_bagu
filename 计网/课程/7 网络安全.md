# 一、网络安全问题概述

## 1.1 计算机网络面临的安全性威胁

计算机网络上的通信面临以下两大类威胁：**被动攻击**和**主动攻击**。

![[Pasted image 20221128101015.png]]

被动攻击
	1. 指攻击者从网络上窃听他人的通信内容。
	2. 通常把这类攻击称为**截获**。
	3. 在被动攻击中，攻击者只是观察和分析某一个协议数据单元 PDU，以便了解所交换的数据的某种性质。但不干扰信息流。
	4. 这种被动攻击又称为**流量分析** (traffic analysis)。

主动攻击主要有：
	1. 篡改——故意篡改网络上传送的报文。这种攻击方式有时也称为更改报文流。
	2. 恶意程序——种类繁多，对网络安全威胁较大的主要包括：计算机病毒、计算机蠕虫、特洛伊木马、逻辑炸弹、后门入侵、流氓软件等。
	3. 拒绝服务——指攻击者向互联网上的某个服务器不停地发送大量分组，使该服务器无法提供正常服务，甚至完全瘫痪。

### 分布式拒绝服务DDoS

若从互联网上的成百上千的网站集中攻击一个网站，则称为**分布式拒绝服务 DDoS** (Distributed Denial of Service)。

有时也把这种攻击称为**网络带宽攻击**或**连通性攻击**。

### 计算机网络通信安全的目标

对于主动攻击，可以采取适当措施加以检测。

对于被动攻击，通常却是检测不出来的。

**对付被动攻击**可采用各种数据**加密**技术。

**对付主动攻击**则需将**加密**技术与适当的**鉴别**技术相结合。

## 1.2 安全的计算机网络

网络的安全性是不可判定的。

一个安全的计算机网络应达到四个目标：

1.保密性
	1. 只有信息的发送方和接收方才能懂得所发送信息的内容。
	2. 是网络安全通信的最基本的内容，也是对付被动攻击必须具备的功能。
	3. 为了使网络具有保密性，需要使用各种密码技术。

2.端点鉴别
	1. 鉴别信息的发送方和接收方的真实身份。
	2. 在对付主动攻击中是非常重要的。

3.信息的完整性
	1. 信息的内容未被篡改过。
	2. 在应对主动攻击中是必不可少的。
	3. 信息的完整性与端点鉴别往往是不可分割的。
	4. 在谈到“鉴别”时，也同时包含了端点鉴别和报文完整性。

4.运行的安全性
	1. 系统能正常运行并提供服务。
	2. 访问控制 (access control) 对计算机系统的安全性是非常重要的。必须对访问网络的权限加以控制，并规定每个用户的访问权限。


## 1.3 数据加密模型

![[Pasted image 20221128101446.png]]

### 密钥

![[Pasted image 20221128101525.png]]

### 一些重要概念

**密码编码学** (cryptography) 是密码体制的设计学。

**密码分析学** (cryptanalysis) 则是在未知密钥的情况下从密文推演出明文或密钥的技术。

密码编码学与密码分析学合起来即为**密码学** (cryptology)。

# 二、两类密码体制

## 2.1 对称密钥密码体制

所谓常规密钥密码体制，即**加密密钥**与**解密密钥是相同的密码体制**。
这种加密系统又称为**对称密钥系统**。

![[Pasted image 20221128101753.png]]

### 2.1.1 数据加密标准DES

- 数据加密标准 DES 属于**对称密钥密码体制**，是一种**分组密码**。
- 在加密前，先对整个明文进行分组。每一个组长为 64 位。
- 然后对每一个 64 位 二进制数据进行加密处理，产生一组 64 位密文数据。
- 最后将各组密文串接起来，即得出整个的密文。
- 使用的密钥为 64 位（**实际密钥长度为 56 位**，有 8 位用于奇偶校验)。
- DES 使用 16 个循环，使用异或，置换，代换，移位操作四种基本运算。

### 2.1.2 DES的保密性

- **DES 的保密性仅取决于对密钥的保密**，其算法是公开的。
- 目前较为严重的问题是 DES 的密钥的长度。
- 现在已经设计出搜索 DES 密钥的专用芯片。56位 DES 已不再认为是安全的了。
- 更多采用高级加密标准（Advanced Encryption Standard，**AES**）

### 2.1.3 三重DES

![[Pasted image 20221128101940.png]]

## 2.2 公钥密码体制

公钥密码体制（又称为公开密钥密码体制）使用**不同的加密密钥与解密密钥**，是一种“由已知加密密钥推导出解密密钥在计算上是不可行的”密码体制。

公钥密码体制产生的主要原因：
	1. 常规密钥密码体制的**密钥分配**问题。
	2. 对**数字签名**的需求。


在公钥密码体制中，**加密密钥** PK（public key，即公钥）是向公众**公开**的，而**解密密钥** SK（secret key，即私钥或秘钥）则是需要**保密**的。

加密算法 E 和解密算法 D 也都是**公开**的。

**私钥 SK 是由公钥 PK 决定的，但很难根据 PK 计算出 SK**。

### 2.2.1 怎么用公钥生成私钥

![[Pasted image 20221128102606.png]]

![[Pasted image 20221128102614.png]]

**任何加密方法的安全性取决于密钥的长度，以及攻破密文所需的计算量**。在这方面，公钥密码体制并不具有比传统加密体制更加优越之处。

由于目前公钥加密算法的开销较大，在可见的将来还看不出来要放弃传统的加密方法。

### 2.2.2 公钥算法的特点

密钥对产生器产生出接收者 B 的一对密钥：加密密钥 PKB 和解密密钥 SKB 。

加密密钥 PKB 就是接收者B的公钥，它向公众公开。

解密密钥 SKB 就是接收者B的私钥，对其他人都保密。

发送者 A 用 B 的公钥 PKB 对明文 X 加密（E 运算）后，接收者 B 用自己的私钥 SKB 解密（D 运算），即可恢复出明文：

![[Pasted image 20221128103112.png]]

![[Pasted image 20221128103119.png]]

### 2.2.3 公钥密码体制

![[Pasted image 20221128103151.png]]

在使用对称密钥时，由于双方使用同样的密钥，因此在通信信道上可以进行**一对一的双向保密通信**，每一方既可用此密钥加密明文，并发送给对方，也可接收密文，用同一密钥对密文解密。这种保密通信仅限于持有此密钥的双方（如再有第三方就不保密了）。

在使用公开密钥时，在通信信道上可以是**多对一的单向保密通信**。

如果某一信息用**公开密钥加密**，则必须用**私有密钥解密**，这就是实现**保密**的方法

如果某一信息用**私有密钥加密**，那么，它必须用**公开密钥解密**。这就是实现**数字签名**的方法

# 三、数字签名

- 用于证明真实性。
- 数字签名必须保证以下三点：
1. 报文鉴别——接收者能够核实发送者对报文的签名（**证明来源**）；
2. 报文的完整性——发送者事后不能抵赖对报文的签名（**防否认**）；
3. 不可否认——接收者不能伪造对报文的签名（**防伪造**）。

现在已有多种实现各种数字签名的方法。但**采用公钥算法更容易实现**。

![[Pasted image 20221128103346.png]]

![[Pasted image 20221128103352.png]]

# 四、鉴别

在信息的安全领域中，对付被动攻击的重要措施是加密，而**对付主动攻击中的篡改和伪造则要用鉴别** (authentication)。

**报文鉴别**使得通信的接收方能够验证所收到的报文（发送者和报文内容、发送时间、序列等）的真伪。

使用加密就可达到报文鉴别的目的。但在网络的应用中，许多报文并不需要加密。应当使接收者能用很简单的方法鉴别报文的真伪。

可再把鉴别细分为两种。
	**报文鉴别**：即鉴别所收到的报文的确是报文的发送者所发送的，而不是其他人伪造的或篡改的。这就包含了端点鉴别和报文完整性的鉴别。
	**实体鉴别**：仅仅鉴别发送报文的实体。实体可以是一个人，也可以是一个进程（客户或服务器）。这就是端点鉴别。

## 4.1 报文鉴别

许多报文并不需要加密，但却需要数字签名，以便让报文的接收者能够**鉴别报文的真伪**。

然而对很长的报文进行数字签名会使计算机增加很大的负担（需要进行很长时间的运算）。

当我们传送不需要加密的报文时，应当使接收者能用很简单的方法鉴别报文的真伪。

### 4.1.1 密码散列函数

数字签名就能够实现对报文的鉴别。

但这种方法有一个很大的**缺点**：对较长的报文（这是很常见的）进行数字签名会使计算机增加非常大的负担，因为这需要较多的时间来进行运算。

**密码散列函数** (cryptographic hash function)是一种相对简单的对报文进行鉴别的方法。

#### 散列函数的两个特点

1. 散列函数的输入长度可以很长，但其输出长度则是固定的，并且较短。散列函数的输出叫做散列值，或更简单些，称为散列。
2. 不同的散列值肯定对应于不同的输入，但不同的输入却可能得出相同的散列值。这就是说，散列函数的输入和输出并非一一对应，而是多对一的。

#### 密码散列函数的特点

在密码学中使用的散列函数称为密码散列函数。

特点：单向性。
1. 要找到两个不同的报文，它们具有同样的密码散列函数输出，在计算上是不可行的。
2. 也就是说，密码散列函数实际上是一种单向函数 (one-way function)。

![[Pasted image 20221128103719.png]]

### 4.1.2 实用的密码散列函数 MD5 和 SHA-1

通过许多学者的不断努力，已经设计出一些实用的密码散列函数（或称为散列算法），其中最出名的就是 MD5 和 SHA-1。

报文摘要算法 MD5 公布于RFC 1321 (1991年)，并获得了非常广泛的应用。

SHA-1比 MD5 更安全，但计算起来却比 MD5 要慢些。

#### MD5算法

MD5 是**报文摘要 MD** (Message Digest) 的第 5 个版本。报文摘要算法 MD5 公布于 RFC 1321 (1991 年)，并获得了非常广泛的应用。

MD5 的设计者 Rivest 曾提出一个猜想，即根据给定的 MD5 报文摘要代码，要找出一个与原来报文有相同报文摘要的另一报文，其难度在计算上几乎是不可能的。

基本思想：
用足够复杂的方法将报文的数据位充分“弄乱”，报文摘要代码中的每一位都与原来报文中的每一位有关。

计算步骤：
1. **附加**：把任意长的报文按模 264 计算其余数（64位），追加在报文的后面（长度项）。
2. **填充**：在报文和长度项之间填充 1～512 位，使得填充后的总长度是 512 的整数倍。填充的首位是 1，后面都是 0。

![[Pasted image 20221128103854.png]]

3. 分组：把追加和填充后的报文分割为一个个 512 位的数据块，每个 512 位的报文数据再分成 4 个 128 位的数据块。

4. 计算：将 4 个 128 位的数据块依次送到不同的散列函数进行 4 轮计算。每一轮又都按 32 位的小数据块进行复杂的运算。一直到最后计算出 MD5 报文摘要代码（128 位）。

#### 安全散列算法（SHA-1）

安全散列算法 SHA (Secure Hash Algorithm)是由美国标准与技术协会 NIST 提出的一个散列算法系列。

SHA 比 MD5 更安全，但计算起来却比 MD5 要慢些。

已制定 SHA-1、SHA-2、 SHA-3 等版本。

基本思想：
1. 要求输入码长小于 2^64 位，输出码长为 160 位。
2. 将明文分成若干 512 位的定长块，每一块与当前的报文摘要值结合，产生报文摘要的下一个中间结果，直到处理完毕。
3. 共扫描 5 遍，效率略低于 MD5，抗穷举性更高。

## 4.2 实体鉴别

实体鉴别与报文鉴别不同。

报文鉴别是对每一个收到的报文都要鉴别报文的发送者。

实体鉴别是在系统接入的全部持续时间内对和自己通信的对方实体**只需验证一次**。

### 4.2.1 最简单的实体鉴别过程

可以使用共享的对称密钥实现实体鉴别。

A 发送给 B 的报文的被加密，使用的是对称密钥 KAB 。

B 收到此报文后，用共享对称密钥 KAB 进行解密，因而鉴别了实体 A 的身份。 因为该密钥只有 A 和 B 知道。

![[Pasted image 20221128104031.png]]